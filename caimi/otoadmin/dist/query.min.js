var Common=function(a){return a={getUrlData:function(){var a=location.search.substring(1),b=a.split("&"),c={},d={},e="";return $.each(b,function(a,b){/func/.test(b)&&(c.func=b.substring(5)),/cmd/.test(b)&&(c.cmd=b.substring(4)),/province/.test(b)&&(d.province=b.substring(9)),/city/.test(b)&&(d.city=b.substring(5)),/managerCode/.test(b)&&(e=b.substring(12))}),{cmd:c,city:d,managerCode:e}},showLayer:function(a,b){function c(a,b){var c=$(a);0===c.length?$("body").append('<div class="'+a.substring(1)+'">'):c.show(),b&&$(a).html(b)}function d(a,b){$.each(a,function(c,d){d==b&&a.splice(c,1)}),a.push(b)}var e=[];c(a,b),c(".mask"),d(e,a),$(document).on("touchend",".mask",function(){e.length<2&&$(this).hide(),$(e.pop()).hide()})},hideLayer:function(a){$(a).hide(),$(".mask").hide()},ajax:function(b,c,d){var e=a.getUrlData(),f={managerCode:e.managerCode};f=$.extend(f,c,!0),b.msg=JSON.stringify(f),$.ajax({url:"/h5Interface",type:"POST",dataType:"json",data:b,beforeSend:function(){$(".loading").show()},success:function(a){$(".loading").hide(),d(a)}})},select:function(b){var c=a.getUrlData(),d="",e=function(c){if(c=c.resultBeanList,b)$.each(c,function(a,b){d+='<li data-city="'+b.cityCode+'">'+b.cityName+"</li>"}),a.showLayer(".view-select-confirm",'<ul class="select-list">'+d+"</ul>");else{var e=$("#city")[0].dataset.city;e&&($.each(c,function(a,b){b.cityCode===e&&$.each(b.childList,function(a,b){d+='<li data-area="'+b.areaCode+'">'+b.areaName+"</li>"})}),a.showLayer(".view-select-confirm",'<ul class="select-list">'+d+"</ul>"))}};a.ajax({cmd:"9101",func:"areaInfo"},c.city,function(a){"0000"===a.code&&a.result&&e(a.result)}),$(document).on("touchstart",".select-list li",function(){var b=this.dataset.city,c=this.dataset.area;b?($("#city").html(this.innerHTML).attr("data-city",b),a.hideLayer(".view-select-confirm")):c&&($("#area").html(this.innerHTML).attr("data-area",c),a.hideLayer(".view-select-confirm"))})},setTime:function(){var a={fillZero:function(a){return 10>a&&(a="0"+a),a},setWeekDate:function(b,c){var d=new Date;c.val(d.getFullYear()+"-"+a.fillZero(d.getMonth()+1)+"-"+a.fillZero(d.getDate())),d.setTime(d.getTime()-5184e5),b.val(d.getFullYear()+"-"+a.fillZero(d.getMonth()+1)+"-"+a.fillZero(d.getDate()))},setMonthDate:function(b,c){var d=new Date;c.val(d.getFullYear()+"-"+a.fillZero(d.getMonth()+1)+"-"+a.fillZero(d.getDate())),d.setTime(d.getTime()-25056e5),b.val(d.getFullYear()+"-"+a.fillZero(d.getMonth()+1)+"-"+a.fillZero(d.getDate()))},inputFormat:function(a){},inputMaxTime:function(){}};return a},tab:function(a,b,c){a.on("touchend",function(){var a=$(this),c=a.index();a.children().addClass("active"),a.siblings().children().removeClass(),b.hide(),b.eq(c).show()})},template:function(a,b,c){var d=template(b,c);a.html(d)}}}(Common||{}),drawChart=function(a,b,c){a.highcharts({chart:{type:"area"},title:{text:" "},xAxis:{title:{text:""},min:0,minorGridLineDashStyle:"dashed",minorGridLineWidth:1,minorTickLength:"10",minorTickInterval:"30",minorGridLineColor:"#ccc",gridLineWidth:1,categories:b},yAxis:{title:{text:""},min:0,minorGridLineDashStyle:"dashed",minorGridLineWidth:1,minorTickLength:"10",minorTickInterval:"30",minorGridLineColor:"#ccc"},plotOptions:{area:{enableMouseTracking:!1,pointStart:0,fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(.2).get("rgba")],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(.2).get("rgba")]]},lineWidth:5,lineColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#4bcff2"],[1,"#2f87de"]]},marker:{enabled:!1},shadow:!1,states:{hover:{lineWidth:1}},threshold:null}},tooltip:{enabled:!1},series:[{type:"area",data:c}]})};$(function(){var a=function(a,b){var c={},d=function(a){var d=b.cmd.func,e={};switch(d){case"registReport":e.name="注册",e.count=1,e.func="registReport",e.cmd=b.cmd.cmd;break;case"payReport":e.name="投注",e.count=2,e.func="payReport",e.cmd=b.cmd.cmd;break;case"chargeReport":e.name="充值",e.count=2,e.func="chargeReport",e.cmd=b.cmd.cmd;break;case"commissionReport":e.name="佣金",e.count=1,e.func="commissionReport",e.cmd=b.cmd.cmd;break;case"profitReport":e.name="卡券兑换",e.count=1,e.func="profitReport",e.cmd=b.cmd.cmd}c.tabheader=e},e=function(a){var b=function(a){return"number"!=typeof a&&(a=Number(a)),a.toFixed(2)},d=function(a){for(var c=[],d=0;d<a.dataX.length;d++)c.push({});return $.each(a,function(a,d){"dataY"==a?$.each(d,function(a,b){c[a].number=b}):"dataY1"==a?$.each(d,function(a,b){c[a].number=b}):"dataY2"==a?$.each(d,function(a,d){c[a].price=b(d)}):"dataX"==a&&$.each(d,function(a,b){c[a].date=b})}),c};c.detail=d(a)},f=function(a){function b(a){var b=/(\d{2}\-\d{2})$/;return b.exec(a)[0]}var c=[];return $.each(a,function(a){c[a]=""}),c[0]=b(a.shift()),c[c.length-1]=b(a.pop()),c};$.isPlainObject(a)?(d(),e(a),Common.template($(".chart-layout"),"searchtemp",c),Common.tab($(".tab-header div"),$(".tab-cont .cont")),a.dataX=f(a.dataX),drawChart($("#chart1"),a.dataX,a.dataY||a.dataY1),a.dataY2&&drawChart($("#chart2"),a.dataX,a.dataY||a.dataY2)):a===!1&&(c.notFound=0,Common.template($(".chart-layout"),"searchtemp",c))},b=function(){var b,c=$("#city").get(0).dataset.city,d=$("#area").get(0).dataset.area,e=$("#startTime"),f=$("#endTime"),g=Common.getUrlData(),h=!0;if(h){h=!1,c&&d?b=d:c?b=c:g.city&&g.city.province&&g.city.city?b=g.city.city:g.city&&g.city.province&&(b=g.city.province);var i={areaCode:b,startDate:e.val(),endDate:f.val()};Common.ajax(g.cmd,i,function(b){"0000"===b.code&&b.result?a(b.result,g):"9001"===b.code&&a(!1,g),h=!h})}};$("#city").on("touchstart",function(){Common.select("top")}),$("#area").on("touchstart",function(){Common.select()});var c=$("#startTime"),d=$("#endTime"),e=Common.setTime();e.setWeekDate(c,d),$("#weekbtn").on("touchend",function(){e.setWeekDate(c,d)}),$("#monthbtn").on("touchend",function(){e.setMonthDate(c,d)}),$(".btn-sub").on("touchend",function(){b()}),b(),$("#startTime").mobiscroll("setVal",c.val()).date({theme:"android-holo",mode:"mixed",display:"bottom",lang:"",dateFormat:"yy-mm-dd",dateOrder:"yymmdd",monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],setText:"确定",cancelText:"取消",ampmText:"",amText:""}),$("#endTime").mobiscroll("setVal",d.val()).date({theme:"android-holo",mode:"mixed",display:"bottom",lang:"",dateOrder:"yymmdd",dateFormat:"yy-mm-dd",monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],setText:"确定",cancelText:"取消",ampmText:"",amText:""})});