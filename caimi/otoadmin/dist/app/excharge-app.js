require.config({baseUrl:"../../dist",paths:{zepto:"libs/zepto.min",jquery:"libs/jquery-2.1.3.min"}}),require(["jquery","utils/caimi-imgload","utils/caimi-core-url","utils/caimi-version"],function(a,b,c,d){var e,f=!0,g=function(){for(var a=document.getElementById("tab"),b=a.getElementsByTagName("div")[0],c=b.getElementsByTagName("span"),d=b.getElementsByTagName("img"),e=a.getElementsByTagName("div")[1],f=e.getElementsByTagName("ul"),g=0;g<c.length;g++)c[g].index=g,c[g].onclick=function(){h(this.index)};var h=function(a){for(var b=0;b<c.length;b++)d[b].style.display="none",f[b].style.display="none";d[a].style.display="block",f[a].style.display="block"};return{changeTab:h}},h=function(){var b={oData:{bBtn:!0,isBindMoblie:!1},init:function(){var d={};a(".btn_ljcy").eq(0).on("touchend",function(){var a=this;setTimeout(function(){b.toPartake.call(a)},300)}),require(["utils/caimi-core-ajax"],function(f){var g=f.loginStatus;f.post(c.activitylist,{group:2,userCode:g.userCode,clientSid:g.sid},function(c){if("0000"===c.code){try{c.result.exchangeList.length||a(".btn_ljcy").addClass("disabled")}catch(f){}try{d=c.result.exchangeList[0].detailList[0],e=d.exchangeDetailId,"1"==d.status&&b.showScuess()}catch(f){}i.init(),b.oData.isBindMoblie=c.result.bindMobile}else require(["utils/caimi-core-layer"],function(a){a.error(c.msg)})})})},toPartake:function(){function d(a){b.oData.bBtn&&e&&(b.oData.bBtn=!1,require(["utils/caimi-core-ajax"],function(d){l.html("请稍后..."),d.post(c.joinExchange,{userCode:a.userCode,exchangeDetailId:e,machId:a.machId},function(a){var c;"0000"===a.code?(c=a.result.code,"0000"===c?(b.showScuess(),require(["utils/caimi-core-layer"],function(a){a.alert("您已成功兑换80元红包")})):"2009"===c?(b.toExcharge(i),h(k)):"2010"===c?require(["utils/caimi-core-layer"],function(a){a.confirmLayer({tit:"此活动需要您绑定手机号",accept:{label:"去绑定",callBack:function(){this.hide(),setTimeout(function(){location.href="icaimi:host:bind"},1e3)}},cancel:{label:"取消",callBack:function(){}}})}):(require(["utils/caimi-core-layer"],function(b){b.error(a.result.msg)}),h(k))):(require(["utils/caimi-core-layer"],function(b){b.error(a.msg)}),h(k))})}))}function h(a){l.html(a),b.oData.bBtn=!0}var i,j,k,l=a(this);k=l.html(),f?require(["utils/caimi-core-versionnumber"],function(a){i=a.version,j=a.loginStatus,"undefined"!=typeof e&&(j.userCode?b.oData.isBindMoblie?d(j):require(["utils/caimi-core-layer"],function(a){a.confirmLayer({tit:"此活动需要您绑定手机号",accept:{label:"去绑定",callBack:function(){this.hide(),setTimeout(function(){location.href="icaimi:host:bind"},1e3)}},cancel:{label:"取消",callBack:function(){}}})}):location.href="icaimi:host:login")}):g().changeTab(1)},showScuess:function(){a(".success-tips").show(),a(".btn_ljcy").html("立即参与"),f=!1},toExcharge:function(a){location.search;require(["utils/caimi-core-layer"],function(b){a.iphone?b.alert("您的余额不足，请立即充值"):b.confirmLayer({tit:"您的现金余额不足，是否充值？",accept:{label:"去充值",callBack:function(){this.hide(),location.href="icaimi:host:recharge"}},cancel:{label:"取消",callBack:function(){}}})})}};return b}();h.init();var i=function(){var b={oData:{bBtn:!0},init:function(){require(["utils/caimi-core-ajax"],function(d){d.post(c.awardDetail,{userCode:d.loginStatus.userCode,privateKey:d.loginStatus.id,shareType:"active"},function(c){if("0000"===c.code){try{a.isPlainObject(c.result)&&(c.result.extraAwardList=c.result.extraAwardList.reverse()),d.loginStatus.userCode||(c.result={},c.result.baseAward={},c.result.baseAward.amount=-1)}catch(e){}b.showList(c.result)}})})},showList:function(c){var d=template("temcont",c);a(".reword-status").html(d);var e=template("base",c.baseAward);a(".show-base-reword").html(e),b.takeReword()},takeReword:function(){var b,d,e,f=!0;a(".can-take a").on("touchend",function(){b=this.dataset.id,e=a(this),d=e.parents(".can-take"),f&&(f=!1,d.hasClass("disabled")||require(["utils/caimi-core-ajax"],function(a){a.post(c.receiveAward,{shareExtraId:b},function(a){"0000"===a.code?(e.html("已领取"),d.removeClass("can-take").addClass("light"),f=!0):require(["utils/caimi-core-layer"],function(b){b.error(a.msg)})})}))})}};return b}(),j=function(){var c={init:function(){location.search;b.imgLoad(a("img[_src]").get(),function(){a(".loading").hide().next().show()}),g()}};return c}();j.init()});